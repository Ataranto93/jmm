= User Manual - File Renaming =

Guide on the File Renaming tab in JMM Desktop

<wiki:toc max_depth="4" />

== Introduction ==

The File Renaming tab allows you to configure how you would like to rename your files (optional of course)<br>

It allows you to set up a profile to automatically rename your files as they are imported into your collection, or rename files already in your collection<br>

The renaming functionality provided is a subset of the functionality provided by WebAOM, with some modifications
http://wiki.anidb.net/w/WebAOM#Move.2Frename_system<br>

Renaming works by taking the metadata provided by AniDB, and then using this information to rename your files<br>

=== Scripting ===

You will need to create a script which contains a series of rules, tests and replacement tags which determines how your file will be renamed<br>

Use the tests to create a string of tags and other text which will be used ro rename the file.<br>

==== Tests ====

For most tests you can insert '!' inside the brackets to indicate NOT<br>
For example <br>
{{{
IF A(69) DO FAIL // If the anime id is 69 (Naruto) then don't rename the file
IF A(!69) DO FAIL // If the anime id is NOT 69 (Naruto) then don't rename the file
}}}

For some tests it will also allow the following operators. These will be referred to as *numerical operators* below<br>
{{{
> // Greater Than
>= // Greater Than or Equal To
< // Less Than
<= // Less Than or Equal To
}}}

You can have multiple tests on one line by using the AND and OR operators<br>
However you cannot have both an AND and an OR on the same line<br>
{{{
, // OR
; // AND
IF A(69),A(1),A(2) DO FAIL // If Anime ID is 69 or 1 or 2, do not rename the file
IF I(epn);I(!epr) DO ADD '%epn' //If the episode has an romaji title but not an english title add the romaji episode title
}}}

|| *Test* || *Example* || *Explanation** ||
|| A || A(69) || Test if the anime for the file has the specified Anime ID ||
|| G || G(1012)|| Group id or 'unknown' ||
|| E || E(67987)|| Episode number ||
|| H || H(S)|| Episode Type [E=episode, S=special, T=trailer, C=credit, P=parody, O=other] ||
|| X || X(13) ,  X(<100) || Total number of episodes, Numerical operators allowed, only for normal episodes not specials, credits etc ||
|| R || R(DVD)|| Rip source [Blu-ray, unknown, camcorder, TV, DTV, VHS, VCD, SVCD, LD, DVD, HKDVD, www] ||
|| T || T(TV)|| Type [unknown, TV, OVA, Movie, Other, web] ||
|| Y || Y(2008)|| Year first aired, Numerical operators allowed ||
|| D || D(english)|| Dub language (one of the audio tracks) [japanese, english, ...] ||
|| S || S(english)|| Sub language (one of the subtitle tracks) [japanese, english, ...] ||
|| I || I(ann)|| Tag is defined. Do not use %, i.e. I(eng) [eng, kan, rom, ann, ...] ||
|| C || C(H264/AVC)|| Video Codec (one of the video tracks) [H264/AVC, DivX5/6, unknown, VP Other, WMV9 (also WMV3), XviD, ...] ||
|| J || J(FLAC)|| Audio Codec (one of the audio tracks) [AC3, FLAC, MP3 CBR, MP3 VBR, Other, unknown, Vorbis (Ogg Vorbis)  ...] ||
|| Z || Z(10)|| Video Bit Depth, Numerical operators allowed [8,10] ||
|| W || W(>=1280) || Video Resolution Width, Numerical operators allowed, [720, 1280, 1920, ...] ||
|| U || U(>=1080) || Video Resolution Height, Numerical operators allowed, [576, 720, 1080, ...] ||

==== Tags ====

Tags are always inside single quotes, preceded by a % and three letters long<br>
Tags will be replaced with the metadata from AniDB

|| *Tag* || *Replaced With**  ||
|| %ann || Anime Name - Romaji ||
|| %kan || Anime Name - Kanji ||
|| %eng || Anime Name - English ||
|| %epn || Episode Name - Romaji ||
|| %epr || Episode Name - English ||
|| %enr || Episode Number ||
|| %grp || Group Name - Short ||
|| %grl || Group Name - Long ||
|| %ed2/%ED2 || ED2K - Lower/Upper ||
|| %crc/%CRC || CRC- Lower/Upper ||
|| %ver || File Version ||
|| %qua || Video Quality ||
|| %src || Video Source ||
|| %res || Video Resolution ||
|| %yea || Year ||
|| %eps || Episode Count ||
|| %typ || Anime Type // [unknown, TV Series, OVA, Movie, TV Special, Other, web] ||
|| %fid || File ID ||
|| %aid || Anime ID ||
|| %eid || Episode ID ||
|| %gid || Group ID ||
|| %dub || Dub Language ||
|| %sub || Sub Language ||
|| %vid || Video codec (tracks separated with ' ||
|| %aud || Audio codec (tracks separated with ' ||
|| %bit || Video Bit Depth (8bit, 10bit) ||
|| %sna || The original file name as specified by the sub group ||
|| %cen || Censored ||
|| %dep || Deprecated ||

==== Scripting Basics ====

|| *Syntax* || *Example* || *Explanation** ||
|| // || `// This is a comment` || This is used to indicate a comment, and everything after this willl be ignored ||
|| ' ' || `' Version_%ver '` || Everything inside the single quotes will be added to the file name including spaces.||
|| %tag || `%ann` || Tags are preceded by a % and will be replaced with the metadata.||

==== Scripting Rules ====

 * Scripts are not validated so you must make sure they conform to the rules
 * You can only have one action `DO ADD` per line

=== Sample Scripts ===

==== General Example ====
{{{
IF A(69) DO FAIL //Do not rename file if it is Naruto
// Sub groups
DO ADD '[%grp] ' //sub group name short
// Anime Name
IF I(eng) DO ADD '%eng - ' // if the anime has an official/main title english add it to the string
IF I(ann);I(!eng) DO ADD '%ann - ' //If the anime has a romaji title but not an english title add the romaji anime title
// Episode number
DO ADD '%enr - ' //Add the Episode number, same for all files
// Episode name
IF I(epr) DO ADD '%epr' //If the episode has an english title add to string
IF I(epn);I(!epr) DO ADD '%epn' //If the episode has an romaji title but not an english title add the romaji episode title
// Audio and subtitle languages
IF I(sub) DO ADD ' (SUB:%sub)'
IF I(dub) DO ADD ' (LAN:%dub)'
// FILE Version
IF F(!1) DO ADD ' [v%ver]' //If the file is not version 1, add the file version
}}}

==== Format:  Sample 1 ====

*Output:* `[Coalgirls]_Highschool_of_the_Dead_-_01_(1920x1080_Blu-ray_H264)_[90CC6DC1].mkv`<br>
*Script*<br>
{{{
// Sub group name
DO ADD '[%grp] '
// Anime Name, use english name if it exists, otherwise use the Romaji name
IF I(eng) DO ADD '%eng '
IF I(ann);I(!eng) DO ADD '%ann '
// Episode Number, don't use episode number for movies
IF T(!Movie) DO ADD '- %enr'
// If the file version is v2 or higher add it here
IF F(!1) DO ADD 'v%ver'
// Video Resolution
DO ADD ' (%res'
// Video Source (only if blu-ray or DVD)
IF R(DVD),R(Blu-ray) DO ADD ' %src'
// Video Codec
DO ADD ' %vid'
// Video Bit Depth (only if 10bit)
IF Z(10) DO ADD ' %bitbit'
DO ADD ') '
DO ADD '[%CRC]'

// Replacement rules (cleanup)
DO REPLACE ' ' '_' // replace spaces with underscores
DO REPLACE '0x0' ''
DO REPLACE '__' '_'
DO REPLACE '__' '_'

// Replacement rules (codecs)
DO REPLACE 'H264/AVC' 'H264'
DO REPLACE 'DivX5/6' 'DivX'
DO REPLACE 'WMV9' 'WMV9'

DO REPLACE 'MP3 CBR' 'MP3'
DO REPLACE 'MP3 VBR' 'MP3'
DO REPLACE 'Vorbis (Ogg Vorbis)' 'Vorbis'

// Replace all illegal file name characters
DO REPLACE '<' '(' 
DO REPLACE '>' ')' 
DO REPLACE ':' ';' 
DO REPLACE '"' '`'
DO REPLACE '/' '_'
DO REPLACE '\' '_' 
DO REPLACE '|' '_' 
DO REPLACE '?' '_' 
DO REPLACE '*' '_'
}}}

==== Format:  Sample 2 - Video format instead of resolution ====

*Output:* `[Coalgirls]_Highschool_of_the_Dead_-_01_(1080p_Blu-ray_H264)_[90CC6DC1].mkv`<br>
*Script*<br>

{{{
// Sub group name
DO ADD '[%grp] '
// Anime Name, use english name if it exists, otherwise use the Romaji name
IF I(eng) DO ADD '%eng '
IF I(ann);I(!eng) DO ADD '%ann '
// Episode Number, don't use episode number for movies
IF T(!Movie) DO ADD '- %enr'
// If the file version is v2 or higher add it here
IF F(!1) DO ADD 'v%ver'
// Video Format
IF W(>=1920) DO ADD ' (1080p'
IF W(>=1280);W(<1920) DO ADD ' (720p'
IF W(<1280) DO ADD ' (SD'
// Video Source (only if blu-ray or DVD)
IF R(DVD),R(Blu-ray) DO ADD ' %src'
// Video Codec
DO ADD ' %vid'
// Video Bit Depth (only if 10bit)
IF Z(10) DO ADD ' %bitbit'
DO ADD ') '
DO ADD '[%CRC]'

// Replacement rules (cleanup)
DO REPLACE ' ' '_' // replace spaces with underscores
DO REPLACE 'H264/AVC' 'H264'
DO REPLACE '0x0' ''
DO REPLACE '__' '_'
DO REPLACE '__' '_'

// Replace all illegal file name characters
DO REPLACE '<' '('
DO REPLACE '>' ')'
DO REPLACE ':' '-'
DO REPLACE '"' '`'
DO REPLACE '/' '_'
DO REPLACE '/' '_'
DO REPLACE '\' '_'
DO REPLACE '|' '_'
DO REPLACE '?' '_'
DO REPLACE '*' '_'
}}}

==== Format:  Sample 3 ====

*Output:* `Highschool of the Dead - 01 [1920x1080] [Coalgirls].mkv`<br>
*Script*<br>

{{{
// Anime Name, use english name if it exists, otherwise use the Romaji name
IF I(eng) DO ADD '%eng '
IF I(ann);I(!eng) DO ADD '%ann '
// Episode Number, don't use episode number for movies
IF T(!Movie) DO ADD '- %enr'
// If the file version is v2 or higher add it here
IF F(!1) DO ADD 'v%ver'
// Video Resolution
DO ADD ' [%res]'
// Sub group name
DO ADD ' [%grp] '

// Replacement rules (cleanup)
DO REPLACE ' ' '_' // replace spaces with underscores
DO REPLACE '0x0' ''
DO REPLACE '__' '_'
DO REPLACE '__' '_'

// Replacement rules (codecs)
DO REPLACE 'H264/AVC' 'H264'
DO REPLACE 'DivX5/6' 'DivX'
DO REPLACE 'WMV9' 'WMV9'

DO REPLACE 'MP3 CBR' 'MP3'
DO REPLACE 'MP3 VBR' 'MP3'
DO REPLACE 'Vorbis (Ogg Vorbis)' 'Vorbis'

// Replace all illegal file name characters
DO REPLACE '<' '(' 
DO REPLACE '>' ')' 
DO REPLACE ':' ';' 
DO REPLACE '"' '`'
DO REPLACE '/' '_'
DO REPLACE '\' '_' 
DO REPLACE '|' '_' 
DO REPLACE '?' '_' 
DO REPLACE '*' '_'
}}}


==== Format:  Sample 4 - Original File Name ====

*Output:* `[Coalgirls] Highschool of the Dead - 06 [1920x1080 Blu-Ray FLAC] [00AF0C10].mkv`<br>
*Script*<br>

{{{
// Use the file name as original specified by the release group
DO ADD '%sna'
}}}